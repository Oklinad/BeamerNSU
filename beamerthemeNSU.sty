% \RequirePackage{calc}
% \RequirePackage{etoolbox}
\RequirePackage[T2A]{fontenc}
\RequirePackage[utf8]{inputenc}
% \RequirePackage{thmtools}
% \RequirePackage{tikz}
% \hypersetup{colorlinks,
%             urlcolor  = uiblink,
%             linkcolor =,
%             citecolor =}
 
%           
% \NeedsTeXFormat{LaTeX2e}
% \ProvidesClass{NSU}[17/05/2020, NSU]
% \PassOptionsToPackage{svgnames, table}{xcolor}

%
% \RequirePackage{helvet}
% \RequirePackage{pdfpages}
% \RequirePackage{graphicx}
% \RequirePackage[footnotesize,hang]{caption}
% \RequirePackage{hyperref}
% \RequirePackage{tikz}

\RequirePackage{listings}

%
% \RequirePackage{etoolbox}

\RequirePackage[many]{tcolorbox}

%
% \RequirePackage{tabularx}
% \RequirePackage{array}
% \RequirePackage{colortbl}
% \tcbuselibrary{skins}

\RequirePackage{ragged2e}

%
% \RequirePackage{courier}

\usefonttheme{default}


% \mode<presentation>

% "------------- %
% Базовые цвета %
% "------------- %

\definecolor{blue}{RGB}{19, 195, 237}
\definecolor{light_blue}{RGB}{216, 247, 255}
\definecolor{green}{RGB}{114, 200, 30}
\definecolor{light_green}{RGB}{207, 240, 202}
\definecolor{red}{RGB}{226, 7, 19}
\definecolor{light_red}{RGB}{254, 218, 220}

\definecolor{black}{RGB}{0, 0, 0}
\definecolor{ash_grey}{RGB}{58, 58, 57}
\definecolor{cadet_grey}{RGB}{89, 89, 89}
\definecolor{light_gray}{RGB}{166, 166, 166}
\definecolor{white}{RGB}{255, 255, 255}

% "-------------- %
%  Установка темы %
% "-------------- %


\providebool{is_red}
\DeclareOptionBeamer{red}{\setbool{is_red}{true}}
\DeclareOptionBeamer{green}{\setbool{is_red}{false}}

\ifbool{is_red}{
    \newcommand{\fileBackground}{figuras/NSU_Red.eps}
    \newcommand{\fileLogo}{figuras/NSU_solologo_Red.eps}
    \colorlet{mainColor1}{red}
    \colorlet{mainColor2}{red!10}
}{
    \newcommand{\fileBackground}{figuras/NSU_Green.eps}
    \newcommand{\fileLogo}{figuras/NSU_solologo_Green.eps}
    \colorlet{mainColor1}{green}
    \colorlet{mainColor2}{green!10}
}

\setbeamertemplate{background canvas}{%
    \ifnum\c@framenumber=1%
        \includegraphics[trim=0 540 0 540, clip, width=\paperwidth, height=\paperheight]{\fileBackground}
    \else%
        \includegraphics[trim=0 1080 0 0, clip, width=\paperwidth, height=\paperheight]{\fileBackground}
    \fi%
}


\define@key{beamerframe}{standout}[true]{%
    \usebackgroundtemplate{\includegraphics[trim=0 0 0 1080, clip, width=\paperwidth, height=\paperheight]{\fileBackground}}
}


% "---------------- %
%  Установка цветов %
% "---------------- %

% Main structure colors
\colorlet{bodyColor}{white}
\colorlet{titleColor}{mainColor1}
\colorlet{chipColor}{mainColor1}

% Sections colors
\colorlet{sectionColor}{black}
\colorlet{subsectionColor}{ash_grey}

% Footline colors
\colorlet{authorFootlineColor}{ash_grey}
\colorlet{instituteFootlineColor}{ash_grey}
\colorlet{titleFootlineColor}{mainColor1}
\colorlet{pageFootlineColor}{ash_grey}
\colorlet{dateFootlineColor}{ash_grey}

% Block colors
\colorlet{normalTitleBlockColor}{mainColor1}
\colorlet{normalBlockColor}{mainColor2}
\colorlet{exampleTitleBlockColor}{blue}
\colorlet{exampleBlockColor}{light_blue}
\colorlet{alertTitleBlockColor}{red}
\colorlet{alertBlockColor}{light_red}

% Code colors
\definecolor{CodeGreen}{rgb}{0,0.6,0}
\definecolor{CodePurple}{rgb}{0.58,0,0.82}
\definecolor{CodeOrange}{rgb}{1,.45,0}
\definecolor{CodeGrey}{rgb}{0.92,0.92,0.92}

% Text colors
% Main structure:
\colorlet{normalTextColor}{black}
\colorlet{titleTextColor}{white}
\colorlet{chipTextColor}{white}
% Sections:
\colorlet{sectionTextColor}{white}
\colorlet{subsectionTextColor}{white}
% Special:
\colorlet{exampleTextColor}{blue}
\colorlet{emphaseTextColor}{red}
\colorlet{alertTextColor}{green}
% Footline:
\colorlet{authorFootlineTextColor}{white}
\colorlet{instituteFootlineTextColor}{white}
\colorlet{titleFootlineTextColor}{white}
\colorlet{pageFootlineTextColor}{white}
\colorlet{dateFootlineTextColor}{white}
% Blocks:
\colorlet{blockTitleTextColor}{white}
\colorlet{blockBodyTextColor}{black}
% Tables:
\colorlet{tableTitleTextColor}{white}
\colorlet{tableBodyTextColor}{black}







%SHRIFTI

\setbeamerfont{frametitle}{size={\fontsize{14}{0}}}

\setbeamerfont{author in head/foot}{size={\fontsize{6}{0}}}
\setbeamerfont{title in head/foot}{size={\fontsize{6}{0}}}
\setbeamerfont{institute in head/foot}{size={\fontsize{6}{0}}}
\setbeamerfont{date in head/foot}{size={\fontsize{6}{0}}}

% "--------- %
%  Структуры %
% "--------- %
% http://www.cpt.univ-mrs.fr/~masson/latex/Beamer-appearance-cheat-sheet.pdf

\usecolortheme[named=black]{structure}
\useinnertheme{rectangles}
\setbeamertemplate{navigation symbols}{}

% Text
\setbeamercolor{titlelike}{fg=titleTextColor,bg=titleColor}
\setbeamercolor*{normal text}{fg=normalTextColor,bg=bodyColor}
\setbeamercolor*{example text}{fg=exampleTextColor}
\setbeamercolor*{alerted text}{fg=alertTextColor}

\newcommand{\exemple}[1]{{\color{example text.fg} #1}}
\renewcommand{\emph}[1]{\textcolor{red}{\textbf{#1}}}

% Items
\setbeamercolor{itemize item}{fg=titleColor!70}
\setbeamercolor{enumerate item}{fg=titleColor!70}
\setbeamercolor{description item}{fg=titleColor!70}

% Frame



\setbeamertemplate{frametitle} {
% \bfseries
\ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}
\@tempdima=\textwidth
\advance\@tempdima by\beamer@leftmargin
\advance\@tempdima by\beamer@rightmargin
\pgfsetfillopacity{.0}
\begin{beamercolorbox}[sep=0.4cm,left,wd=\the\@tempdima]{frametitle}
	\usebeamerfont{frametitle}
	\vbox{}
	\vskip-1.6ex
% 	\hspace{-1.5ex}
	\if@tempswa\else\csname beamer@fteleft\endcsname\fi
	\strut\pgfsetfillopacity{1}\insertframetitle\strut\par{
	\ifx\insertframesubtitle\@empty
	\else
		{\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\insertframesubtitle\strut\par}
	\fi
	}
	\vskip-1ex
	\if@tempswa\else\vskip-.3cm\fi
\end{beamercolorbox}
}

% Footline
\setbeamercolor{author in head/foot}{bg=authorFootlineColor, fg=authorFootlineTextColor}
\setbeamercolor{title in head/foot}{bg=titleFootlineColor, fg=titleFootlineTextColor}
\setbeamercolor{institute in head/foot}{bg=instituteFootlineColor, fg=instituteFootlineTextColor}
\setbeamercolor{date in head/foot}{bg=dateFootlineColor, fg=dateFootlineTextColor}



\defbeamertemplate*{footline}{infolines theme}{
\ifnum \theframenumber=1%

\else%
    % \leavevmode%
    % \series
    \hbox{%
        \begin{beamercolorbox}[wd=.3\paperwidth,ht=6px,dp=2.5px,left]{author in head/foot}%
        	\usebeamerfont{author in head/foot}\hspace*{2ex}\insertshortauthor
        \end{beamercolorbox}%
        \begin{beamercolorbox}[wd=.4\paperwidth,ht=6px,dp=2.5px,center]{title in head/foot}%
        	\usebeamerfont{title in head/foot}\insertshorttitle
        \end{beamercolorbox}%
        \begin{beamercolorbox}[wd=.3\paperwidth,ht=6px,dp=2.5px,right]{date in head/foot}%
        	\usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2ex}
        	\insertframenumber{}/\inserttotalframenumber\hspace*{2ex}
        \end{beamercolorbox}%
    }
    \vskip0pt%
\fi%
}


\mode
<all>

% "----------------- %
% Обновление команд %
% "----------------- %

\setbeamertemplate{title page}{
    \hspace{0.25\linewidth}
    \begin{minipage}{0.81\linewidth}\small\centering
    	\begin{beamercolorbox}[sep=8pt,center]{institute}
    		\usebeamerfont{institute}\insertinstitute
    	\end{beamercolorbox}
    	\begin{beamercolorbox}[sep=8pt,center]{title}
    		\usebeamerfont{title}\inserttitle\par
    		\ifx\insertsubtitle\@empty
    		\else
    			\vskip0.25em
    			{\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}
    		\fi
    	\end{beamercolorbox}
    	\vskip1em\par
    	\begin{beamercolorbox}[sep=8pt,center]{author}
    		\usebeamerfont{author}\insertauthor
    	\end{beamercolorbox}
    	\begin{beamercolorbox}[sep=8pt,center]{date}
    		\usebeamerfont{date}\insertdate
    	\end{beamercolorbox}
    \end{minipage}
}

\setbeamertemplate{section in toc}{\includegraphics[trim = 60 45 0 0, clip, scale=0.18]{\fileLogo}~\inserttocsection}
\setbeamertemplate{subsection in toc}{\hspace{1.5em}\includegraphics[trim = 60 45 0 0, clip, scale=0.18]{\fileLogo}~\inserttocsubsection\par}
\setbeamertemplate{itemize items}{\includegraphics[trim = 60 45 0 0, clip, scale=0.18]{\fileLogo}}

\apptocmd{\frame}{}{\justifying}{} % Allow optional arguments after frame.

\renewcommand{\arraystretch}{1.15} % Space between lines in table
% \setlength{\tabcolsep}{0.5}

\newcommand{\urlcolor}[1]{\textcolor{magenta}{#1}}
\newcommand{\cref}[2]{\urlcolor{\href{#1}{#2}}} % margenta href

\newcommand{\code}[1]{\codebox{\centering\texttt{#1}}}
\newcommand{\mytitle}[1]{\titlebox{\centering\texttt{#1}}}

% footnote whitout index number
% \newcommand\blfootnote[1]{%
%     \begingroup
%     \renewcommand\thefootnote{}\footnote{#1}%
%     \addtocounter{footnote}{-1}%
%     \endgroup
% }

% "------- %
% Таблица %
% "------- %

\tcbset{nsutable/.style={enhanced,
		arc=0em,
		fonttitle=\bfseries,
		fontupper=\normalsize\sffamily,
		colback=mainColor2!100!white,
		colframe=mainColor1!70!black,
		colbacktitle=mainColor1!100!white,
		coltitle=white,
		center title}}

% "----- %
% Блоки %
% "----- %


\setbeamertemplate{blocks}[rectangle]

\setbeamercolor*{block title}{fg=blockTitleTextColor,bg=normalTitleBlockColor}
\setbeamercolor*{block body}{fg=blockBodyTextColor,bg=normalBlockColor}

\setbeamercolor*{block title alerted}{fg=blockTitleTextColor,bg=alertTitleBlockColor}
\setbeamercolor*{block body alerted}{fg=blockBodyTextColor,bg=alertBlockColor}

\setbeamercolor*{block title example}{fg=blockTitleTextColor,bg=exampleTitleBlockColor}
\setbeamercolor*{block body example}{fg=blockBodyTextColor,bg=exampleBlockColor}

\setbeamerfont{block title}{series=\bfseries, size={}}

\AtBeginEnvironment{block}{\setbeamercolor{itemize item}{fg=normalTitleBlockColor!70}}
\AtBeginEnvironment{exampleblock}{\setbeamercolor{itemize item}{fg=exampleTitleBlockColor!70}}
\AtBeginEnvironment{alertblock}{\setbeamercolor{itemize item}{fg=alertTitleBlockColor!70}}

% "----- %
% Боксы %
% "----- %

\newcommand{\codebox}[1]{
\begin{center}
	\begin{tcolorbox}[colback=mainColor2,
			colframe=mainColor1,
			arc=3mm, auto outer arc,
			boxrule=1.5pt]
		#1
	\end{tcolorbox}
\end{center}
}

\newcommand{\titlebox}[1]{
\begin{center}
	\begin{tcolorbox}[colback=mainColor1,
			coltitle=white,
			colframe=mainColor1,
			arc=0mm, auto outer arc,
			boxrule=1.5pt]
		#1
	\end{tcolorbox}
\end{center}
}

\newcommand{\textbox}[1]{
\begin{center}
	\fcolorbox{mainColor2}{mainColor2}{
	\begin{minipage}{1.\textwidth}
		#1
	\end{minipage}
	}
\end{center}
}

% "------------------ %
% Стиль вставок кода %
% "------------------ %

\definecolor{backcolour}{RGB}{245,245,245}
\definecolor{commentcolour}{RGB}{0,128,0}
\definecolor{keywordcolour}{RGB}{249,38,114}
\definecolor{stringcolour}{RGB}{255,102,0}

\renewcommand\lstlistingname{Algoritimo}
\lstdefinestyle{mystyle}{
backgroundcolor=\color{backcolour},
commentstyle=\color{commentcolour},
keywordstyle=\color{keywordcolour}\bfseries,
numberstyle=\tiny\color{black},
stringstyle=\color{stringcolour},
emphstyle=\color{red},
basicstyle=\footnotesize,
breakatwhitespace=false,
breaklines=true,
captionpos=t,
keepspaces=true,
numbers=left,
numbersep=5pt,
showspaces=false,
showstringspaces=false,
showtabs=false,
tabsize=2
}

\lstset{style=mystyle}


